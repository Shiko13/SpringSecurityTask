DROP TABLE IF EXISTS trainee_trainer CASCADE;
DROP TABLE IF EXISTS training_types CASCADE;
DROP TABLE IF EXISTS trainees CASCADE;
DROP TABLE IF EXISTS trainers CASCADE;
DROP TABLE IF EXISTS users CASCADE;
DROP TABLE IF EXISTS trainings CASCADE;
CREATE TABLE users (id BIGINT PRIMARY KEY GENERATED ALWAYS AS IDENTITY, first_name VARCHAR(255) NOT NULL, last_name VARCHAR(255) NOT NULL, username VARCHAR(255) NOT NULL, password VARCHAR(255) NOT NULL, is_active BOOLEAN, postfix INTEGER);
CREATE TABLE training_types (id BIGINT PRIMARY KEY GENERATED ALWAYS AS IDENTITY, name VARCHAR(255) NOT NULL);
CREATE TABLE trainees (id BIGINT PRIMARY KEY, date_of_birth DATE, address VARCHAR(255), FOREIGN KEY (id) REFERENCES users(id) ON DELETE CASCADE);
CREATE TABLE trainers (id BIGINT PRIMARY KEY, specialization BIGINT NOT NULL, FOREIGN KEY (specialization) REFERENCES training_types (id) ON DELETE CASCADE, FOREIGN KEY (id) REFERENCES users(id) ON DELETE CASCADE);
CREATE TABLE trainings (id BIGINT PRIMARY KEY GENERATED ALWAYS AS IDENTITY, trainee_id BIGINT NOT NULL, trainer_id BIGINT NOT NULL, name VARCHAR(255) NOT NULL, type_id BIGINT, date DATE NOT NULL, duration BIGINT NOT NULL, CONSTRAINT fk_trainee FOREIGN KEY (trainee_id) REFERENCES trainees(id) ON DELETE CASCADE, CONSTRAINT fk_trainer FOREIGN KEY (trainer_id) REFERENCES trainers(id) ON DELETE CASCADE, CONSTRAINT fk_type FOREIGN KEY (type_id) REFERENCES training_types(id) ON DELETE CASCADE);
CREATE TABLE trainee_trainer (trainee_id BIGINT NOT NULL, trainer_id BIGINT NOT NULL, PRIMARY KEY (trainee_id, trainer_id), CONSTRAINT fk_trainee FOREIGN KEY (trainee_id) REFERENCES trainees(id), CONSTRAINT fk_trainer FOREIGN KEY (trainer_id) REFERENCES trainers(id));
